{
  "$schema": "./data/meta/Requirement.meta.json",
  "$metaSchema": "Requirement",
  "id": "UserAuthenticationApplication",
  "title": "ユーザー認証Application層機能",
  "description": "ユーザー認証機能のアプリケーション層実装",
  "type": "requirement",
  "implementationType": "function",
  "outputPath": {
    "default": "/src/application/authentication/UserAuthenticationApplication.ts"
  },
  "implementation": {
    "function": {
      "parameters": {
        "type": "object",
        "properties": {
          "authenticateCommand": {
            "type": "object",
            "description": "認証コマンド",
            "properties": {
              "username": {
                "type": "string",
                "description": "ユーザー名"
              },
              "password": {
                "type": "string",
                "description": "パスワード"
              },
              "options": {
                "type": "object",
                "description": "認証オプション"
              }
            },
            "required": ["username", "password"]
          }
        },
        "required": ["authenticateCommand"]
      },
      "returnType": {
        "type": "object",
        "description": "アプリケーション層からの認証結果",
        "properties": {
          "success": {
            "type": "boolean",
            "description": "認証が成功したかどうか"
          },
          "userData": {
            "type": "object",
            "description": "認証されたユーザーデータ"
          },
          "authToken": {
            "type": "string",
            "description": "認証トークン"
          },
          "expiration": {
            "type": "string",
            "format": "date-time",
            "description": "トークンの有効期限"
          },
          "errorDetails": {
            "type": "object",
            "description": "詳細なエラー情報",
            "properties": {
              "code": {
                "type": "string",
                "description": "エラーコード"
              },
              "message": {
                "type": "string",
                "description": "エラーメッセージ"
              },
              "stackTrace": {
                "type": "string",
                "description": "スタックトレース（開発環境のみ）"
              }
            }
          }
        },
        "required": ["success"]
      },
      "async": true,
      "exceptions": [
        {
          "name": "ApplicationError",
          "description": "アプリケーション層でのエラー"
        },
        {
          "name": "CommandValidationError",
          "description": "コマンドバリデーションエラー"
        }
      ],
      "sideEffects": true,
      "examples": [
        {
          "description": "コマンドパターンを使った認証",
          "input": {
            "authenticateCommand": {
              "username": "test_user",
              "password": "password123",
              "options": {
                "rememberMe": true
              }
            }
          },
          "output": {
            "success": true,
            "userData": {
              "id": "user123",
              "username": "test_user",
              "roles": ["user"]
            },
            "authToken": "jwt.token.example",
            "expiration": "2025-04-22T05:00:00.000Z"
          }
        }
      ]
    }
  },
  "dependencies": ["UserAuthenticationService"],
  "status": "draft",
  "tags": ["auth", "security", "user", "application"],
  "priority": "high",
  "createdAt": "2025-03-23T05:00:00.000Z",
  "updatedAt": "2025-03-23T05:00:00.000Z"
}