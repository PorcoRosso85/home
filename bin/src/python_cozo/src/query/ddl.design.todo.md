# DDL 設計課題

## 主要課題
1. 深いネスト構造
   - 現在のparent_id方式(隣接リスト)では深さ5階層を超えると再帰クエリのパフォーマンスが急激に低下
   - 例: A.B.C.D.E.Fのような構造の取得に5秒以上かかる(10万レコード規模)

2. 循環依存関係
   - 現在の制約では3階層以上の循環依存を検出できない
   - 例: MessageA → MessageB → MessageC → MessageA の依存連鎖

3. 動的スキーマ操作
   - スキーマ変更時の依存関係連鎖
   - 例: 1つのメッセージ削除で最大152の関連オブジェクト削除が必要になるケース

4. パフォーマンス限界値
   - 想定限界値:
     - メッセージ数: ~50,000
     - 依存関係エッジ数: ~200,000
     - クエリ応答時間: 複数JOIN時で2秒以上

## 改善案
1. 階層管理
   - 隣接リストから閉包テーブルに変更

2. 型参照
   - 文字列から物理外部キーに変更

3. バージョン管理
   - スキーマバージョニングシステムの追加

4. 検証
   - 非同期バリデーションエンジンの導入

5. 依存関係
   - グラフデータベース連携による依存関係管理
