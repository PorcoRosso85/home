# Requirement Graph System レビュー（2025年7月12日）

## レビュー概要

3つのペルソナ（Owner、Manager、Engineer）の視点から、オンライン学習プラットフォームの要件をRequirement Graph Systemに追加し、システムの使用感を評価しました。

## テストシナリオ

### ペルソナ1: オーナー（戦略的視点）
- `lp_owner_001`: グローバル展開可能なプラットフォーム（5年以内に10カ国以上）
- `lp_owner_002`: 月間アクティブユーザー100万人達成（3年以内）
- `lp_owner_003`: 最高の学習体験（業界で最も使いやすい）

### ペルソナ2: マネージャー（実行計画）
- `lp_mgr_001`: 初期版リリース（6ヶ月以内にMVP）
- `lp_mgr_002`: ユーザー登録機能（メール認証付き）
- 依存関係：`lp_owner_002` → `lp_mgr_001` → `lp_mgr_002`

### ペルソナ3: エンジニア（技術実装）
- `lp_eng_001`: JWT認証実装（RFC 7519準拠）
- `lp_eng_002`: パスワードセキュリティ（bcryptでハッシュ化）
- 依存関係：`lp_mgr_002` → `lp_eng_001`

## 評価結果

### ✅ 良かった点

1. **循環依存の検出が優秀**
   - `lp_owner_001` ⇄ `lp_owner_002` の循環を即座に検出
   - エラーメッセージが明確：`"Cycle: lp_owner_002 -> lp_owner_001 -> lp_owner_002"`
   - 要件の整合性を保つ上で重要な機能が確実に動作

2. **JSONベースの簡単な操作**
   - 各ペルソナが自分の視点で要件を追加しやすい
   - テンプレート方式で入力ミスを防げる
   - コマンドラインから直接実行できる利便性

3. **依存関係の可視化**
   - オーナー → マネージャー → エンジニアの階層構造を自然に表現
   - 例：`lp_owner_002`(100万MAU) → `lp_mgr_001`(MVP) → `lp_mgr_002`(登録) → `lp_eng_001`(JWT)
   - プロジェクトの全体像を把握しやすい

4. **深さ制限（30階層）**
   - 実用的な制限で、過度に複雑な構造を防ぐ
   - `lp_deep_001`〜`lp_deep_035`のテストで確認
   - KuzuDBのクエリ制限により、深すぎる階層を防止

### ⚠️ 改善が必要な点

1. **曖昧な要件への警告が不足**
   - `lp_owner_003`「最高の学習体験」のような曖昧な要件に対する摩擦スコアが見えない
   - READMEには摩擦スコアの説明があるが、実際の出力には含まれていない
   - 曖昧さの検出機能が期待通りに動作していない可能性

2. **優先度の競合検出なし**
   - 全ての要件が`priority: 1`になっているが、警告なし
   - ペルソナ間での優先度調整機能が必要
   - 複数人での開発では優先度の衝突は頻繁に発生する

3. **エラーメッセージの改善余地**
   - `Search error: Binder exception: Cannot find property content for r.` が毎回出る
   - PyTorchのインポートエラーも表示されるが、動作には影響なし
   - ユーザー体験を損なう不要なエラー表示

4. **重複要件の検出が機能していない？**
   - 同じような要件を追加しても警告が出ない
   - 「ユーザー登録機能」が複数存在（`EC-001`、`lp_mgr_002`）しても検出されない

### 💡 総評

このシステムは、複数人でのソフトウェア開発における**要件の整合性管理に有効**です。特に：

- **循環依存の防止**が確実に機能
- **階層構造**で要件を整理できる
- **JSON入力**で誰でも使いやすい

ただし、**曖昧さや優先度競合の検出**が実装されていないか、うまく動作していないようです。これらの機能が改善されれば、より実用的なシステムになるでしょう。

## 推奨される改善点

1. **摩擦スコアの可視化**
   - 要件作成時に自動的に摩擦スコアを表示
   - 曖昧な要件に対する具体的な改善提案

2. **重複検出の強化**
   - 類似要件の自動検出と警告
   - VSS（Vector Similarity Search）の活用

3. **優先度管理機能**
   - ペルソナ間での優先度競合の検出
   - 優先度調整のための協議機能

4. **エラーメッセージの整理**
   - 不要なエラー表示の抑制
   - ユーザーフレンドリーなメッセージ

## 結論

「複数人のソフトウェア開発の際のドキュメント作成の煩雑さ」を解決する第一歩として、このシステムは有望です。要件の構造化と依存関係の管理は十分機能していますが、チーム間の調整を支援する機能（優先度競合、曖昧さ検出など）の強化が必要です。