# 外部変数管理アーキテクチャ

## 現状分析

### 問題点
1. **分散した管理**: 外部変数管理が複数ファイルに分散
   - `env_vars.py`: 環境変数（デフォルト値あり）
   - `paths.py`: パス関連（デフォルト値あり）  
   - `constants.py`: 定数（デフォルト値あり）

2. **直接アクセス**: 多くのファイルが `os.environ` に直接アクセス
   - テストファイル: 15ファイル以上
   - アプリケーションコード: hierarchy_udfs.py など

3. **規約違反**: デフォルト値が散在

### 移行後のアーキテクチャ

```
infrastructure/variables/
├── env.py          # すべての外部変数を一元管理（デフォルト値なし）
├── constants.py    # アプリケーション定数（外部変数ではない）
└── __init__.py     # 互換性レイヤー
```

### 保守性の向上

**現在**: 部分的に統一
- variables パッケージレベルでは統一
- 内部実装は分散
- 直接アクセスが多い

**移行後**: 完全に統一
- `env.py` が唯一の外部変数アクセスポイント
- デフォルト値を完全排除
- テスタビリティ向上

### 結論

現在のシステムは外部変数APIが「パッケージレベル」では一か所になっているが、「実装レベル」では分散している。`env.py` への統一により、真の意味で「一か所」になり、保守性が大幅に向上する。