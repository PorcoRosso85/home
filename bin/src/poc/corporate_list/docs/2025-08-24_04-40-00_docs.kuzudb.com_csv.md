warning: Git tree '/home/nixos' is dirty
copying path '/nix/store/h2bn031b0fj0ymv9v7bv5rcdjx58y2l9-source' from 'https://cache.nixos.org'...
this derivation will be built:
  /nix/store/mr2zzjgsz3zgh3yb1mxcvlnjbj00nkli-readability.drv
these 48 paths will be fetched (62.03 MiB download, 297.80 MiB unpacked):
  /nix/store/hil2hhp0zhw426qn2ncg2akasr5dmkbr-acl-2.3.2
  /nix/store/xl1043bxc6q4ymbqrv3pyjmpssd6z0wj-attr-2.5.2
  /nix/store/00zrahbb32nzawrmv9sjxn36h7qk9vrs-bash-5.2p37
  /nix/store/94lg0shvsfc845zy8gnflvpqxxiyijbz-bash-interactive-5.2p37
  /nix/store/ywc5ismph30i5a1w56rl9kxa0a5887wx-bzip2-1.0.8
  /nix/store/ykdv4id6893gmkqwdmbimq237c1xqvq7-bzip2-1.0.8-bin
  /nix/store/psy9v2asypgl9ylg8cnzkixc7fv0snj0-coreutils-9.7
  /nix/store/ibx4jfwlhjg4g0s6rrxrpaxa3ka8ns4m-diffutils-3.12
  /nix/store/r274m06q3qwnkbzw37z0a589rqnzmbpq-ed-1.21.1
  /nix/store/3pdmbqy86wsbjdazxv1n3vrmj60vn0ri-file-5.45
  /nix/store/c14zwgl8hf1wm0izij2i16xvk8ak70cy-findutils-4.10.0
  /nix/store/nv3y7zb1cwz1h9qy7nwz0s54j8dl1kqj-gawk-5.3.2
  /nix/store/l7d6vwajpfvgsd3j4cr25imd1mzb7d1d-gcc-14.3.0-lib
  /nix/store/h8x8m2vcaqd13sm794q5l3yrynbf3h0q-gcc-14.3.0-libgcc
  /nix/store/q4wq65gl3r8fy746v9bbwgx4gzn0r2kl-glibc-2.40-66
  /nix/store/3qf4dg256fginainsz0scm9mdsahh03i-gmp-with-cxx-6.3.0
  /nix/store/s3dj57ywp7j6az9xbc3yssjlwnlw335q-gnu-config-2024-01-01
  /nix/store/bc6zxzjnkjp4r9nhz5imy3cypvdh6r4n-gnugrep-3.12
  /nix/store/6bwp1y45zlyvpr4ja2sk1yi9v5mrs94x-gnumake-4.4.1
  /nix/store/pr318zsl44jdwpk9wk0sdrn19b6in7ah-gnused-4.9
  /nix/store/lp82dcnrzljyix6yigwzrlpr1smvpmb0-gnutar-1.35
  /nix/store/6ag5dhk7sma61p6vl0kazfmpbrq08nqh-gzip-1.14
  /nix/store/iqyknh55lw1ynrljd3l29c1i1h7vx4rd-icu4c-76.1
  /nix/store/1bbi36a6x3dxkbg0lavcp7hkgp26kw5r-icu4c-76.1-dev
  /nix/store/ncdwsrgq6n6161l433m4x34057zq0hhf-libidn2-2.3.8
  /nix/store/vm18dxfa5v7y3linrg1x1q9wx41bkxwf-libunistring-1.3
  /nix/store/g2fpxrchs8ys5rzwbdc9jh2wvpr4p2cl-libuv-1.51.0
  /nix/store/4nnxjcr6jd7i2x41lnclw5wqkh1njzfv-libuv-1.51.0-dev
  /nix/store/in8rmhvx0zxk7n76yfp0gsadvgj7pxaf-ncurses-6.5
  /nix/store/g6lyzm0jm9v5bxxxsk8w27wn5zzh6lh4-nodejs-20.19.3
  /nix/store/pjr8jcds298brhwy1d3rmym9vayxhbfs-nodejs-22.16.0
  /nix/store/byx7ahs386pskh8d5sdkrkpscfz9yyjp-openssl-3.4.1
  /nix/store/74k8qwbfa6lm8psm2vjh2vj04fpr6c5g-openssl-3.4.1-bin
  /nix/store/k0699a27nkj4c2xn67bjcpfa08nqn9l4-openssl-3.4.1-dev
  /nix/store/c9xmgszbf6i4dfq9r953khk9d7fdqigw-patch-2.8
  /nix/store/1c8sm86wj45vwkb3ww2b870h9i9wna6r-patchelf-0.15.0
  /nix/store/hqb180lba3mik6agk0dn2s4hhq9y32bh-pcre2-10.44
  /nix/store/zl2k2ayhk22q2s6pvgm7qb8f07zzhq6p-readline-8.2p13
  /nix/store/x5mzmqjvmiz6ydabfwhvv0mrimln4k3l-sqlite-3.50.1
  /nix/store/mg2qj052ihy3mr33ag41qbhqb36zrp8k-sqlite-3.50.1-bin
  /nix/store/q70y1hc004sa6h8hd4jvg3l8ybwa11r1-sqlite-3.50.1-dev
  /nix/store/c68csbhqnd52ffs0s14a0gwgjargq1b2-stdenv-linux
  /nix/store/063qqmawmq7bg75b56mgynw9s3rbx2ww-update-autotools-gnu-config-scripts-hook
  /nix/store/j4kybm2h5l6ing0i494zwdswp672pmgv-xgcc-14.3.0-libgcc
  /nix/store/nm296vfrn2hqrb6yisablznknp9p7hx9-xz-5.8.1
  /nix/store/ikfwx7kbwz9zr7fziiac7f57jgbh3bnv-xz-5.8.1-bin
  /nix/store/vx438ll7xvv9q5ns8mqpphsg2dxg9yi9-zlib-1.3.1
  /nix/store/99mambdfxnpm6rkdjbf1hhgdg87caxa3-zlib-1.3.1-dev
copying path '/nix/store/h8x8m2vcaqd13sm794q5l3yrynbf3h0q-gcc-14.3.0-libgcc' from 'https://cache.nixos.org'...
copying path '/nix/store/s3dj57ywp7j6az9xbc3yssjlwnlw335q-gnu-config-2024-01-01' from 'https://cache.nixos.org'...
copying path '/nix/store/vm18dxfa5v7y3linrg1x1q9wx41bkxwf-libunistring-1.3' from 'https://cache.nixos.org'...
copying path '/nix/store/j4kybm2h5l6ing0i494zwdswp672pmgv-xgcc-14.3.0-libgcc' from 'https://cache.nixos.org'...
copying path '/nix/store/063qqmawmq7bg75b56mgynw9s3rbx2ww-update-autotools-gnu-config-scripts-hook' from 'https://cache.nixos.org'...
copying path '/nix/store/ncdwsrgq6n6161l433m4x34057zq0hhf-libidn2-2.3.8' from 'https://cache.nixos.org'...
copying path '/nix/store/q4wq65gl3r8fy746v9bbwgx4gzn0r2kl-glibc-2.40-66' from 'https://cache.nixos.org'...
copying path '/nix/store/xl1043bxc6q4ymbqrv3pyjmpssd6z0wj-attr-2.5.2' from 'https://cache.nixos.org'...
copying path '/nix/store/l7d6vwajpfvgsd3j4cr25imd1mzb7d1d-gcc-14.3.0-lib' from 'https://cache.nixos.org'...
copying path '/nix/store/00zrahbb32nzawrmv9sjxn36h7qk9vrs-bash-5.2p37' from 'https://cache.nixos.org'...
copying path '/nix/store/r274m06q3qwnkbzw37z0a589rqnzmbpq-ed-1.21.1' from 'https://cache.nixos.org'...
copying path '/nix/store/hqb180lba3mik6agk0dn2s4hhq9y32bh-pcre2-10.44' from 'https://cache.nixos.org'...
copying path '/nix/store/byx7ahs386pskh8d5sdkrkpscfz9yyjp-openssl-3.4.1' from 'https://cache.nixos.org'...
copying path '/nix/store/nm296vfrn2hqrb6yisablznknp9p7hx9-xz-5.8.1' from 'https://cache.nixos.org'...
copying path '/nix/store/nv3y7zb1cwz1h9qy7nwz0s54j8dl1kqj-gawk-5.3.2' from 'https://cache.nixos.org'...
copying path '/nix/store/pr318zsl44jdwpk9wk0sdrn19b6in7ah-gnused-4.9' from 'https://cache.nixos.org'...
copying path '/nix/store/in8rmhvx0zxk7n76yfp0gsadvgj7pxaf-ncurses-6.5' from 'https://cache.nixos.org'...
copying path '/nix/store/ywc5ismph30i5a1w56rl9kxa0a5887wx-bzip2-1.0.8' from 'https://cache.nixos.org'...
copying path '/nix/store/g2fpxrchs8ys5rzwbdc9jh2wvpr4p2cl-libuv-1.51.0' from 'https://cache.nixos.org'...
copying path '/nix/store/6bwp1y45zlyvpr4ja2sk1yi9v5mrs94x-gnumake-4.4.1' from 'https://cache.nixos.org'...
copying path '/nix/store/vx438ll7xvv9q5ns8mqpphsg2dxg9yi9-zlib-1.3.1' from 'https://cache.nixos.org'...
copying path '/nix/store/4nnxjcr6jd7i2x41lnclw5wqkh1njzfv-libuv-1.51.0-dev' from 'https://cache.nixos.org'...
copying path '/nix/store/hil2hhp0zhw426qn2ncg2akasr5dmkbr-acl-2.3.2' from 'https://cache.nixos.org'...
copying path '/nix/store/c9xmgszbf6i4dfq9r953khk9d7fdqigw-patch-2.8' from 'https://cache.nixos.org'...
copying path '/nix/store/x5mzmqjvmiz6ydabfwhvv0mrimln4k3l-sqlite-3.50.1' from 'https://cache.nixos.org'...
copying path '/nix/store/3pdmbqy86wsbjdazxv1n3vrmj60vn0ri-file-5.45' from 'https://cache.nixos.org'...
copying path '/nix/store/mg2qj052ihy3mr33ag41qbhqb36zrp8k-sqlite-3.50.1-bin' from 'https://cache.nixos.org'...
copying path '/nix/store/99mambdfxnpm6rkdjbf1hhgdg87caxa3-zlib-1.3.1-dev' from 'https://cache.nixos.org'...
copying path '/nix/store/ykdv4id6893gmkqwdmbimq237c1xqvq7-bzip2-1.0.8-bin' from 'https://cache.nixos.org'...
copying path '/nix/store/ikfwx7kbwz9zr7fziiac7f57jgbh3bnv-xz-5.8.1-bin' from 'https://cache.nixos.org'...
copying path '/nix/store/6ag5dhk7sma61p6vl0kazfmpbrq08nqh-gzip-1.14' from 'https://cache.nixos.org'...
copying path '/nix/store/lp82dcnrzljyix6yigwzrlpr1smvpmb0-gnutar-1.35' from 'https://cache.nixos.org'...
copying path '/nix/store/bc6zxzjnkjp4r9nhz5imy3cypvdh6r4n-gnugrep-3.12' from 'https://cache.nixos.org'...
copying path '/nix/store/zl2k2ayhk22q2s6pvgm7qb8f07zzhq6p-readline-8.2p13' from 'https://cache.nixos.org'...
copying path '/nix/store/3qf4dg256fginainsz0scm9mdsahh03i-gmp-with-cxx-6.3.0' from 'https://cache.nixos.org'...
copying path '/nix/store/iqyknh55lw1ynrljd3l29c1i1h7vx4rd-icu4c-76.1' from 'https://cache.nixos.org'...
copying path '/nix/store/1c8sm86wj45vwkb3ww2b870h9i9wna6r-patchelf-0.15.0' from 'https://cache.nixos.org'...
copying path '/nix/store/94lg0shvsfc845zy8gnflvpqxxiyijbz-bash-interactive-5.2p37' from 'https://cache.nixos.org'...
copying path '/nix/store/q70y1hc004sa6h8hd4jvg3l8ybwa11r1-sqlite-3.50.1-dev' from 'https://cache.nixos.org'...
copying path '/nix/store/74k8qwbfa6lm8psm2vjh2vj04fpr6c5g-openssl-3.4.1-bin' from 'https://cache.nixos.org'...
copying path '/nix/store/psy9v2asypgl9ylg8cnzkixc7fv0snj0-coreutils-9.7' from 'https://cache.nixos.org'...
copying path '/nix/store/k0699a27nkj4c2xn67bjcpfa08nqn9l4-openssl-3.4.1-dev' from 'https://cache.nixos.org'...
copying path '/nix/store/c14zwgl8hf1wm0izij2i16xvk8ak70cy-findutils-4.10.0' from 'https://cache.nixos.org'...
copying path '/nix/store/ibx4jfwlhjg4g0s6rrxrpaxa3ka8ns4m-diffutils-3.12' from 'https://cache.nixos.org'...
copying path '/nix/store/c68csbhqnd52ffs0s14a0gwgjargq1b2-stdenv-linux' from 'https://cache.nixos.org'...
copying path '/nix/store/1bbi36a6x3dxkbg0lavcp7hkgp26kw5r-icu4c-76.1-dev' from 'https://cache.nixos.org'...
copying path '/nix/store/g6lyzm0jm9v5bxxxsk8w27wn5zzh6lh4-nodejs-20.19.3' from 'https://cache.nixos.org'...
copying path '/nix/store/pjr8jcds298brhwy1d3rmym9vayxhbfs-nodejs-22.16.0' from 'https://cache.nixos.org'...
building '/nix/store/mr2zzjgsz3zgh3yb1mxcvlnjbj00nkli-readability.drv'...
# Import data from CSV files

You can bulk import data to node and relationship tables from CSV files
using the `COPY FROM` command. It is **highly recommended** to use `COPY FROM` if you are creating large
databases. You can use `COPY FROM` to import data into an empty table or to append data to an existing table.

There are a set of CSV configurations you can set during `COPY FROM` (as well as `LOAD FROM`). We will cover
these parameters below in the [CSV Configurations](#csv-configurations) section. This page first covers
examples of loading into node and relationship tables. Please see the section about [Ignoring Erroneous Rows](/import#ignore-erroneous-rows)
on how to skip erroneous CSV rows during the import.

## Import to node table

Create a node table `User` as follows:

```
CREATE NODE TABLE User(name STRING PRIMARY KEY, age INT64, reg_date DATE)
```

The CSV file `user.csv` contains the following fields:

```
name,age,reg_dateAdam,30,2020-06-22Karissa,40,2019-05-12...
```

The following statement will load `user.csv` into User table.

```
COPY User FROM "user.csv" (header=true);
```

## Import to relationship table

When loading into a relationship table, Kuzu assumes the first two columns in the file are:

- `FROM` Node Column: The primary key of the `FROM` nodes.
- `TO` Node Column: The primary key of the `TO` nodes.

The rest of the columns correspond to relationship properties.

Create a relationship table `Follows` using the following Cypher query:

```
CREATE REL TABLE Follows(FROM User TO User, since DATE)
```

This reads data from the below CSV file `follows.csv`:

```
Adam,Karissa,2010-01-30Karissa,Michelle,2014-01-30...
```

The following statement loads the `follows.csv` file into a `Follows` table.

```
COPY Follows FROM "follows.csv";
```

Note that the header wasn’t present in the CSV file, hence the `header` parameter is not set.

To skip the first 3 lines of the CSV file, you can use the `SKIP` parameter as follows:

```
COPY Follows FROM "follows.csv" (SKIP=3);
```

## Import multiple files to a single table

It is common practice to divide a large CSV file into several smaller files for cleaner data management.
Kuzu can read multiple files with the same structure, consolidating their data into a single node or relationship table.
You can specify that multiple files are loaded in the following ways:

### Glob pattern

This is similar to the Unix [glob](https://man7.org/linux/man-pages/man7/glob.7.html) pattern, where you specify
file paths that match a given pattern. The following wildcard characters are supported:

| Wildcard | Description |
| --- | --- |
| `*` | match any number of any characters (including none) |
| `?` | match any single character |
| `[abc]` | match any one of the characters enclosed within the brackets |
| `[a-z]` | match any one of the characters within the range |

```
COPY User FROM "User*.csv"
```

### List of files

Alternatively, you can just specify a list of files to be loaded.

```
COPY User FROM ["User0.csv", "User0.csv", "User2.csv"]
```

## CSV configurations

There are a set of configurations that can be set when importing CSV files, such as
whether the CSV file has a header that should be skipped during loading or what the delimiter character
between the columns of the CSV is. See below for the list of all supported configurations. These
configurations can be manually set by specifying parameters inside `( )` at the
end of the `COPY FROM` clause. Several of the supported configurations, such as the header and delimiter characters,
are automatically detected if they are not manually specified at the end of `COPY FROM` clause.
See the subsections below for more details on how Kuzu automatically detects these configurations.

The following configuration parameters are supported:

| Parameter | Description | Default Value |
| --- | --- | --- |
| `HEADER` | Whether the first line of the CSV file is the header. Can be true or false. | false |
| `DELIM` or `DELIMITER` | Character that separates different columns in a lines. | `,` |
| `QUOTE` | Character to start a string quote. | `"` |
| `ESCAPE` | Character within string quotes to escape QUOTE and other characters, e.g., a line break.  See the important note below about line breaks lines below. | `\` |
| `SKIP` | Number of rows to skip from the input file | `0` |
| `PARALLEL` | Read CSV files in parallel or not | `true` |
| `IGNORE_ERRORS` | Skips malformed rows in CSV files if set to true. Use [`SHOW_WARNINGS`](/cypher/query-clauses/call#show_warnings) function to view information about malformed rows. Also see [`CLEAR_WARNINGS`](/cypher/query-clauses/call#clear_warnings) function. See more on [Warnings table](/import#warnings-table-inspecting-skipped-rows) to inspect skipped rows. | `false` |
| `auto_detect` | Turn ON/OFF the auto detection of configurations (more details below) | `true` |
| `sample_size` | The number of sample CSV lines to use when auto detecting CSV configurations (more details below) | 256 |
| `NULL_STRINGS` | The strings that should be treated as nulls in the CSV file. | `""` (empty string) |

For example, the query below specifies that the CSV delimiter is `|` and also that the header row exists.

```
COPY User FROM "user.csv" (HEADER=true, DELIM="|");
```

If any of the following configuration options are not manually specified at the end of the `COPY FROM` statement,
by default Kuzu will try to automatically detect them:

- HEADER
- DELIM
- QUOTE
- ESCAPE

If you specify a subset of these manually but not the others, then only those that have not been specified will be automatically detected.
You can turn off auto-detection by setting `(auto_detect=false)` as a parameter, in which case Kuzu will default to using the default values
for any of the unspecified configurations. For example, consider the example from above again:

```
COPY User FROM "user.csv" (HEADER=true, DELIM="|");
```

In this case (which is equivalent to `COPY User FROM "user.csv" (HEADER=true, DELIM="|", auto_detect=true)`),
Kuzu will try to automatically detect the `QUOTE` and `ESCAPE` characters.
It will not try to automatically detect if the first line is a header line or the `DELIM` character,
since those configurations are manually specified in the query.
If instead the query was:

```
COPY User FROM "user.csv" (HEADER=true, DELIM="|", auto_detect=false);
```

Then, Kuzu will use the default values of `QUOTE` and `ESCAPE`, which are `"` and `\` respectively (and use
the manually specified configurations for `HEADER` and `DELIM`).

### Sample size parameter

By default, Kuzu will use the first 256 lines of the CSV file to auto-detect unspecified configurations.
If you want to use a different number of lines, you can specify the `sample_size` parameter.

You can find more information on how Kuzu automatically tries to detect these configurations below.

### Header auto detection

Kuzu parses the first line of the CSV into columns and checks if each column can be cast to the data type of the target column in the node or rel table that is being copied into.
If so, the line is assumed to be a valid “data” line and inserted as a record into the target table. Otherwise, it is assumed to be
a header line and skipped.

### Delimiter, quote and escape character auto detection

Kuzu uses the first `sample_size` lines to auto detect any configuration that has not been manually specified.
The possible configurations for different configurations are:

- DELIM: `,`, `|`, `;`, `\t`.
- QUOTE: `"`, `'` and (no quote character)
- ESCAPE: `"`, `'`, `\` and (no escape character)

### Null strings handling

By default, Kuzu treats only empty strings ( `""`) as `NULL` values. However, in certain scenarios, the default behaviour may not be sufficient. For example, if you’re working with a CSV file exported by a tool that uses the string `"NULL"` to represent nulls, you can modify Kuzu’s behaviour by setting the `NULL_STRINGS` parameter to include both the empty string and the string `"NULL"`:

```
LOAD FROM 'xxx.csv'(null_strings=[null_str1, null_str2, null_str3]) RETURN *;
```

## Compressed CSV files

To reduce file size, CSV files are often distributed in compressed formats. Kuzu supports directly scanning `*.csv.gz` files (compressed with `gzip`)
without requiring manual decompression. Simply specify the file path in the `LOAD FROM` or `COPY FROM` clause.

Assume that you compress the `user.csv` from above with the `gzip` command:

Terminal window ```
gzip -k user.csv
```

Then, you can use the `LOAD FROM` clause to scan the compressed file directly.

```
LOAD FROM 'user.csv.gz' RETURN *;
```

```
┌─────────┬───────┬────────────┐│ name    │ age   │ reg_date   ││ STRING  │ INT64 │ DATE       │├─────────┼───────┼────────────┤│ Adam    │ 30    │ 2020-06-22 ││ Karissa │ 40    │ 2019-05-12 │└─────────┴───────┴────────────┘
```

## Ignore erroneous rows

See the [Ignore erroneous rows](/import#ignore-erroneous-rows) section for more details.
