# グラフDB中心型エラーハンドリング設計

## 権限モデル

```
Root Claude (DML) → Graph DB ← Project Claude (DQL)
                 (決定事項の唯一源)
```

## 基本原則

1. **決定事項の一元化**: 全ての決定はグラフDBにのみ存在
2. **権限分離**: ルートClaudeのみ書き込み、プロジェクトClaudeは読み取り専用
3. **成果物自動生成**: プロジェクトClaudeは決定事項から成果物を生成

## グラフ構造

### ノード
- Decision: エラーパターンと解決策のマッピング
- ProjectRule: プロジェクト固有のルール
- Validation: 決定事項の検証結果

### エッジ
- DEPENDS_ON: 決定事項間の依存関係
- SUPERSEDES: 決定事項の更新履歴
- VALIDATED_BY: ルールの妥当性検証

## 実行フロー

1. **起動時**: プロジェクトClaudeが該当URI決定事項を取得
2. **エラー時**: パターンマッチングで解決策を検索
3. **成果物生成**: 決定事項に基づく自動コード生成

## 実装段階

- Phase 1: JSON形式の模擬グラフ
- Phase 2: DuckDBでのリレーショナル実装
- Phase 3: KuzuDBでの本格実装（自己参照）

## 利点

- 単一の真実源による一貫性
- 明確な責任分界
- トレーサビリティの確保
- 自動化による効率化