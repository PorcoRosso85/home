# WANT.md - 期待される機能要望

## 目標
LSMCPの機能をCLIから直接実行できるようにし、リファクタリングや参照検索を容易にする。

## 期待される使用方法

```bash
# 理想的なコマンド例
nix run .#lsmcp -- <language> <feature> [options]

# 例：
nix run .#lsmcp -- python find-references Calculator main.py:10
nix run .#lsmcp -- python rename-symbol oldName newName src/**/*.py
nix run .#lsmcp -- python get-diagnostics src/**/*.py
```

## 具体的な機能要望

### 1. 変数の参照検索
- 変数名を入力すると、同じ変数が使用されているすべての場所を一覧表示
- ファイルパス、行番号、コンテキストを含む出力
- 例：`Calculator`クラスがどこで定義され、どこで使用されているか

### 2. 参照元・参照先の情報取得
- ある変数/関数/クラスの定義位置を表示
- その要素を参照しているすべての場所を表示
- 依存関係の可視化

### 3. シンボルのリネーム
- プロジェクト全体で安全にシンボル名を変更
- 変更前のプレビュー表示
- 自動的にすべての参照を更新

### 4. 診断結果の取得
- エラー、警告、型エラーなどを一括取得
- ファイルパターンで対象を絞り込み
- JSON形式での出力オプション

## 技術的な課題と現状

### 現在のLSMCPの制限
1. MCPサーバーとしての動作が前提
2. --includeオプションはTypeScript専用の実装
3. 他言語でのCLI診断は未実装

### 解決アプローチ案

#### Option A: LSMCPの拡張
- 各言語アダプターにCLI実行モードを追加
- MCPサーバーを介さない直接実行パス

#### Option B: Nix Flakeでのラッパー実装
- LSPサーバーを起動してJSON-RPCで通信
- 結果を整形してCLI出力
- 言語ごとの差異を吸収

#### Option C: 専用CLIツールの作成
- LSMCPのコア機能を再利用
- CLI特化の新しいエントリーポイント

## 期待される効果

1. **開発効率の向上**
   - IDEなしでコードナビゲーション可能
   - バッチ処理でのリファクタリング

2. **自動化の促進**
   - CIでのコード品質チェック
   - スクリプトからの呼び出し

3. **言語非依存の統一インターフェース**
   - どの言語でも同じコマンドで操作
   - 学習コストの削減