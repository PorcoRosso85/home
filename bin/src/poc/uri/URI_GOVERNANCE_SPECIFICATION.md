# URI生成の安全性とガバナンス仕様

## 問題提起：ISO標準準拠だけでは安全性は保証されない

ISO標準に準拠することは、URIの「意味の正しさ」や「網羅性」を担保する上で非常に強力な出発点ですが、URI生成プロセス全体の「安全性（= 意図しない重複や誤りを防ぎ、一貫性を保つこと）」を自動的に保証するものではありません。

その理由は、**標準（Standard）とガバナンス（Governance）は別物**だからです。ISO標準はあくまで「地図」であり、その地図を使って誰が、どのようなルールで、いつ、どのように「住所（URI）を登録するか」という統治（ガバナンス）の仕組みがなければ、混乱は避けられません。

## 「安全」が脅かされる具体的なリスクシナリオ

ISO標準という正しい地図を持っていても、以下のような問題が発生します。

### 1. 解釈の揺らぎ（The Interpretation Problem）

**シナリオ**: チームAとチームBが、同じISO規格の条文「顧客情報の管理」を読みました。
- チームAはこれを「顧客の基本情報を登録・更新する機能」と解釈し、`.../features/customer-profile` を生成しました。
- チームBはこれを「顧客との全インタラクション履歴を含む包括的な管理機能」と解釈し、`.../features/customer-360-view` を生成しました。

**結果**: 同じ標準を参照しているにも関わらず、異なるスコープを持つ、似て非なるURIが生まれてしまいます。これは重複や混乱の元です。

### 2. 粒度の不一致（The Granularity Problem）

**シナリオ**: ISO 20022の「支払指図 (pacs.008)」を参照する際、
- チームCはそれを一つの機能とみなし、`.../features/payment-initiation` を生成しました。
- チームDは「国内向け」と「海外向け」で実装が大きく異るため、「国内支払指図」「海外支払指図」と分割し、`.../features/domestic-payment` と `.../features/cross-border-payment` の2つを生成しました。

**結果**: どちらが「正」なのでしょうか？標準はそこまでの実装詳細を規定しません。この決定は各組織に委ねられており、ルールがなければバラバラになります。

### 3. ガバナンスの欠如（The Governance Problem）

**シナリオ**: そもそも、新しいLevel 1のURIを誰が、どのタイミングで、どのような申請と承認プロセスを経て登録できるのか、というルールが存在しませんでした。

**結果**:
- ある開発者が、テスト目的で気軽に `.../features/test-payment` を登録してしまい、それが正式なものと誤解されてしまう。
- `payment-initiation` と `payment-instruction` のように、微妙に違うが同じものを指すURIが、異なるチームによって同時に登録されてしまう（競合状態）。
- 機能が廃止されてもURIが残り続け、「死んだURI」がグラフ内に増殖していく。

## 「安全な生成」を保証するために必要なもの：ガバナンスの導入

したがって、技術的な構造（4階層モデル）と参照する標準（ISO）に加えて、それを運用するための**「人間とプロセスの層」＝ガバナンス**が不可欠です。

このガバナンスをASCIIアートに反映させ、最終形態としましょう。

```
+==============================================================================+
| G O V E R N A N C E   P R O C E S S  (URIの安全性を保証する人間系のプロセス) |
|------------------------------------------------------------------------------|
| [URI設計規約] [URI払い出し台帳] [レビューボード(承認機関)] [ライフサイクル管理] |
+==============================================================================+
       ^                  ^                     ^                      ^
       |                  |                     |                      |
(ルールを適用)         (一意性を保証)           (解釈・粒度を承認)     (廃止等を管理)
       |                  |                     |                      |
       v                  v                     v                      v
+--------------------------------+ - - - - - - - - - - - - - - - - - - - - - - - -
| Level 0: Business Capability   |
+--------------------------------+
       +-------------------------------+
       | Capability: Customer Management |
       |(.../capabilities/cust-mgmt)   |
       +-------------------------------+
                     | "支援する (SUPPORTS)"
+--------------------------------+ - - - - - - - - - - - - - - - - - - - - - - - -
| Level 1: Feature (Domain/Service)|
+--------------------------------+
       +------------------------------------+
       | Feature: Payment Initiation        |
       | (.../features/payment-initiation)  |
       +------------------------------------+
                     | "要求カテゴリを持つ (HAS_REQUIREMENTS_IN)"
+--------------------------------+ - - - - - - - - - - - - - - - - - - - - - - - -
| Level 2: Classification        |
+--------------------------------+
       +---------------------------+
       |   Category: ASVS V4 Txn Auth|
       |   (.../asvs/v4.0.3/v6)    |
       +---------------------------+
                     | "含む (CONTAINS)"
+--------------------------------+ - - - - - - - - - - - - - - - - - - - - - - - -
| Level 3: Concrete Requirement  |
+--------------------------------+
       +-------------------------------+
       | V6.2.2: Re-authentication for |
       | sensitive transactions.       |
       +-------------------------------+
```

## ガバナンスコンポーネントの詳細

### 1. URI設計規約
- kebab-caseを使う、バージョン番号を含めるなど、URIの命名規則を文書化します。

### 2. URI払い出し台帳
- 生成された全URIとそのメタデータ（所有者、作成日、ステータス等）を記録する単一の場所（Gitリポジトリ、専用ツール等）を定めます。

### 3. レビューボード
- 新しいLevel 0やLevel 1のURIが提案された際に、その解釈、粒度、命名が適切かどうかを判断し、承認するチームや役割（アーキテクト等）を設置します。

### 4. ライフサイクル管理
- 機能の廃止（DEPRECATED）、統合（MERGED）など、URIの状態を管理するプロセスを定義します。

## 結論

「Level 1の参考とするISO標準に誤りがなく」、かつ**「その標準を解釈し、URIの生成・管理を行うための厳格なガバナンスプロセスが存在し、遵守されている」という2つの条件が揃って初めて、「安全にURIが生成されていく」と断言に近付きます。**

技術（モデル）とプロセス（ガバナンス）の両輪が揃って、初めてシステムは安定走行するのです。