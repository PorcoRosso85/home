import e from"node:async_hooks";import{parentPort as t}from"node:worker_threads";import n from"picocolors";var r=class{constructor(){this.store=new Map,this.contextMap=new Map,this.hook=e.createHook({init:(e,t,n)=>{this.contextMap.has(n)&&this.contextMap.set(e,this.contextMap.get(n))},destroy:e=>{this.contextMap.delete(e)}}),this.hook.enable()}run(t,n,...r){let i=e.executionAsyncId();this.contextMap.set(i,t);let a;try{a=n(...r)}finally{this.contextMap.delete(i)}return a}enterWith(t){let n=e.executionAsyncId();this.store.set(n,t)}getStore(){let t=e.executionAsyncId();return this.store.get(t)||this.contextMap.get(t)}};let i=t===null;var a=class{constructor(){e.AsyncLocalStorage===void 0?(i&&(console.warn(n.yellow(`AsyncLocalStorage is not supported, falling back to async hooks implementation`)),i=!1),this.customAsyncLocalStorage=new r):this.asyncLocalStorage=new e.AsyncLocalStorage}run(e,t,...n){return this.asyncLocalStorage?this.asyncLocalStorage.run(e,t,...n):this.customAsyncLocalStorage.run(e,t,...n)}enterWith(e){this.asyncLocalStorage?this.asyncLocalStorage.enterWith(e):this.customAsyncLocalStorage.enterWith(e)}getStore(){return this.asyncLocalStorage?this.asyncLocalStorage.getStore():this.customAsyncLocalStorage.getStore()}};const o=globalThis.__react_server_context__=globalThis.__react_server_context__||new a;function s(e){let t=o.getStore();return e?t?.[e]??null:t}function c(e,t){let n=o.getStore(),r=typeof e==`object`?e:{[e]:t};Reflect.ownKeys(r).forEach(e=>{n[e]=r[e]})}const l=Symbol.for(`LOGGER_CONTEXT`),u=Symbol.for(`FORM_DATA_PARSER`),d=Symbol.for(`MAIN_MODULE`);Symbol.for(`SERVER_CONTEXT`);const f=Symbol.for(`CLIENT_MODULES_CONTEXT`),p=Symbol.for(`COLLECT_CLIENT_MODULES`),m=Symbol.for(`COLLECT_STYLESHEETS`),h=Symbol.for(`HTTP_CONTEXT`),g=Symbol.for(`HTTP_STATUS`),_=Symbol.for(`HTTP_HEADERS`),v=Symbol.for(`HTTP_OUTLET`),y=Symbol.for(`HTTP_RESPONSE`),b=Symbol.for(`REDIRECT_CONTEXT`);Symbol.for(`MODULE_LOADER`);const x=Symbol.for(`ERROR_BOUNDARY`),S=Symbol.for(`ERROR_COMPONENT`),C=Symbol.for(`ERROR_CONTEXT`);Symbol.for(`MEMORY_CACHE_CONTEXT`);const w=Symbol.for(`CACHE_CONTEXT`),T=Symbol.for(`FLIGHT_CACHE`),E=Symbol.for(`HTML_CACHE`),D=Symbol.for(`CONFIG_ROOT`),O=Symbol.for(`CONFIG_CONTEXT`);Symbol.for(`CONFIG_PARENT`);const k=Symbol.for(`MANIFEST`);Symbol.for(`SSR_CONTROLLER`);const A=Symbol.for(`ROUTE_MATCH`),j=Symbol.for(`STYLES_CONTEXT`);Symbol.for(`BUILD_OPTIONS`);const M=Symbol.for(`ACTION_CONTEXT`),N=Symbol.for(`RELOAD`),P=Symbol.for(`RENDER`),F=Symbol.for(`RENDER_STREAM`),I=Symbol.for(`RENDER_CONTEXT`);Symbol.for(`RENDER_HANDLER`);const L=Symbol.for(`RENDER_TEMPORARY_REFERENCES`),R=Symbol.for(`RENDER_WAIT`);Symbol.for(`WORKER_THREAD`);const z=Symbol.for(`PRELUDE_HTML`),B=Symbol.for(`POSTPONE_STATE`),V=Symbol.for(`IMPORT_MAP`),H=Symbol.for(`CACHE_MISS`);Symbol.for(`CACHE_KEY`),Symbol.for(`CACHE_PROVIDER`);const U=Symbol.for(`CACHE_RESPONSE_TTL`),W=Symbol.for(`SERVER_FUNCTION_NOT_FOUND`);Symbol.for(`LIVE_IO`);function G(){return s(h).url}const K=Object.getOwnPropertyNames(URL.prototype).filter(e=>{let t=Object.getOwnPropertyDescriptor(URL.prototype,e);return t&&t.set});function q(e){let t=s(h),n=typeof e==`string`?new URL(e,t.url):e;return K.forEach(e=>{t.url[e]=n[e]}),t.url}function J(){return decodeURIComponent(s(v)??s(I)?.outlet??s(h)?.request?.headers?.get(`react-server-outlet`)??`PAGE_ROOT`).replace(/[^a-zA-Z0-9_]/g,`_`)}export{k as A,B,z as C,b as D,N as E,P as F,I as G,F as H,L as I,R as J,A as K,W as L,j as M,o as N,c as O,s as P,q as b,J as c,G as d,M as e,w as f,H as g,U as h,f as i,p as j,m as k,O as l,D as m,x as n,S as o,C as p,T as q,u as r,E as s,h as t,_ as u,y as v,g as w,V as x,l as y,d as z};