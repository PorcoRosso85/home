"use client";import{c as e,d as t,e as n,f as r}from"../../../../context.m3qdVQv-.mjs";import{Component as i,createContext as a,createElement as o,isValidElement as s,useContext as c,useEffect as l,useMemo as u,useState as d}from"react";import{Fragment as f,jsx as p,jsxs as m}from"react/jsx-runtime";const h=a(null);function g(){let e=c(h),[t,n]=d({error:null,hasError:!1}),r=u(()=>({resetBoundary:()=>{e.resetErrorBoundary(),n({error:null,hasError:!1})},showBoundary:e=>n({error:e,hasError:!0})}),[e.resetErrorBoundary]);if(t.hasError)throw t.error;return r}const _={didCatch:!1,error:null};var v=class extends i{constructor(e){super(e),this.resetErrorBoundary=this.resetErrorBoundary.bind(this),this.state=_}static getDerivedStateFromError(e){return{didCatch:!0,error:e}}async resetErrorBoundary(...e){let{error:t}=this.state;t!==null&&(await this.props.onReset?.({args:e,reason:`imperative-api`,error:t,resetErrorBoundary:this.resetErrorBoundary}),typeof t?.digest!=`string`&&this.setState(_))}componentDidCatch(e,t){this.props.onError?.(e,t)}componentDidUpdate(e,t){let{didCatch:n}=this.state,{resetKeys:r}=this.props;if(n&&t.error!==null&&y(e.resetKeys,r))if(typeof this.props.onReset==`function`){let t=this.props.onReset({next:r,prev:e.resetKeys,reason:`keys`});typeof t?.then==`function`?t.then(()=>{this.setState(_)}):this.setState(_)}else this.setState(_)}render(){let{children:e,fallbackRender:t,FallbackComponent:n,fallback:r}=this.props,{didCatch:i,error:a}=this.state;a?.message===`Redirect`&&a?.digest.startsWith(`Location=`)&&(a.redirectTo=a.digest.slice(9));let c=e;if(i){let e={error:a,resetErrorBoundary:this.resetErrorBoundary};if(delete a.stack,typeof t==`function`)c=t(e);else if(n)c=o(n,e);else if(r===null||s(r))c=r;else throw a}return p(h.Provider,{value:{didCatch:i,error:a,resetErrorBoundary:this.resetErrorBoundary},children:c})}};function y(e=[],t=[]){return e.length!==t.length||e.some((e,n)=>!Object.is(e,t[n]))}function b({FallbackComponent:e,fallbackRender:i,...a}){let{outlet:o}=c(t),s=r(),{navigate:u}=s,{error:d}=a,{redirectTo:h}=d;return l(()=>{h&&u(h,{outlet:o,external:o!==n})},[h,u,o]),h?null:m(f,{children:[e&&typeof e==`function`?p(e,{...a}):e,i?.(a)]})}function x({error:e}){if(e)throw e;return null}function S({component:n,render:i,onReset:a,global:o,children:s,...l}){let{outlet:u}=c(t),{resourceKey:d,error:f}=c(e),{invalidate:h}=r();return m(v,{...l,onReset:async e=>{typeof e.error?.digest==`string`&&await h(u),a?.(e)},fallbackRender:e=>p(b,{FallbackComponent:n,fallbackRender:i,...e}),children:[p(x,{error:f}),s]},`${u}_${d}`)}export{v as ErrorBoundary,S as default,g as useErrorBoundary};