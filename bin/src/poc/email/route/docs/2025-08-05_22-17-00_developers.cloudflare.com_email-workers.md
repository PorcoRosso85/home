---
url: https://developers.cloudflare.com/email-routing/email-workers/
saved_at: 2025-08-05T22:17:00Z
title: Email Workers - Cloudflare Email Routing
domain: developers.cloudflare.com
---

# Email Workers

Email Workers allow processing and manipulating emails using Cloudflare Workers, enabling complex routing and filtering logic.

## Key Characteristics

- Leverage Workers to implement custom email processing rules
- Can create allowlists, blocklists, and custom routing logic  
- Supports multiple programming languages compatible with Workers

## Basic Email Worker Structure

```javascript
export default {
  async email(message, env, ctx) {
    // message: ForwardableEmailMessage
    // env: Environment bindings
    // ctx: Execution context
    
    // Email processing logic here
  }
}
```

## ForwardableEmailMessage API

The `message` parameter provides methods for email handling:
- `message.from` - Sender email address
- `message.to` - Recipient email address
- `message.headers` - Email headers
- `message.raw()` - Get raw email content
- `message.forward(to)` - Forward email to another address
- `message.setReject(reason)` - Reject the email with a reason

## Example: Allowlist Implementation

```javascript
export default {
  async email(message, env, ctx) {
    const allowList = ["friend@example.com", "coworker@example.com"];
    
    if (allowList.indexOf(message.from) == -1) {
      message.setReject("Address not allowed");
    } else {
      await message.forward("inbox@corp");
    }
  }
}
```

## Implementation Steps

1. **Create the Email Worker** - Define the worker with email handler
2. **Add processing logic** - Implement filtering, routing, or archiving
3. **Bind to email route** - Configure in wrangler.toml

## Configuration (wrangler.toml)

```toml
name = "email-worker"
main = "src/index.js"

[[email_routing_rules]]
type = "all"
actions = [
  { type = "worker", value = "email-worker" }
]
```

## Key Resources

- **Runtime API**: `/email-routing/email-workers/runtime-api/`
- **Local Development**: `/email-routing/email-workers/local-development/`
- **Limits**: `/email-routing/limits/#email-workers-size-limits`

## Limits

- Maximum email size: 25MB
- Worker execution time: 30 seconds (paid plans can extend)