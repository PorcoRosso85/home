# {{PROJECT_NAME}}

{{DESCRIPTION}}

## Quick Start

### 1. Setup secrets
Edit `secrets/app.yaml` with your actual secret values:
```yaml
api_key: "your-actual-api-key"
db_password: "your-actual-password"
```

### 2. Encrypt secrets
```bash
nix run .#encrypt-secrets
```

### 3. Deploy to NixOS

Add to your NixOS configuration:
```nix
{
  imports = [
    inputs.{{PROJECT_NAME}}.nixosModules.default
  ];
  
  services.{{SERVICE_NAME}}.enable = true;
}
```

## Managing Secrets

### Add new secret
```bash
./scripts/add-secret.sh database_url "postgresql://..."
```

### Rotate secrets
```bash
./scripts/rotate-secrets.sh
```

## Architecture

This project implements complete OS/Application separation:
- **OS**: Provides sops-nix decryption capability only
- **Application**: Manages all secrets autonomously

| Component | Responsibility |
|-----------|---------------|
| OS (NixOS) | Provides SSH host key for decryption |
| This App | Defines, encrypts, and manages secrets |

## Development

### Run tests
```bash
./tests/test_all.sh
```

### Check flake
```bash
nix flake check
```

## Troubleshooting

### Cannot decrypt
Ensure your SSH host key matches the one in `.sops.yaml`:
```bash
cat /etc/ssh/ssh_host_ed25519_key.pub
```

### Service not starting
Check logs:
```bash
journalctl -u {{SERVICE_NAME}} -f
```

## License

MIT
