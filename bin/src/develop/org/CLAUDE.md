# ローカル設定（org orchestrator専用）

## ファイル責務
- **このファイル**: /home/nixos/bin/src/develop/org/CLAUDE.md
- **責務**: orchestrator（org）固有の設定とルール
- **親設定**: ~/CLAUDE.md（グローバル共通ルール）

## 責務分離の原則
| ファイル | パス | 責務 | 適用範囲 |
|---------|------|------|----------|
| グローバル | ~/CLAUDE.md | 全体共通原則 | すべてのプロジェクト |
| org専用 | develop/org/CLAUDE.md | orchestrator設定 | orgコマンド実行時 |
| 各プロジェクト | 各プロジェクト/CLAUDE.md | プロジェクト固有 | 該当プロジェクトのみ |

## org固有の非同期タスク管理
- **並列実行の徹底**: 
  - Taskツールで複数サブエージェントを同時起動
  - 各タスク完了時に即座に報告（全完了を待たない）
  - アイドルワーカーを作らない
- **タスクプール管理**:
  ```
  実行中: [Task1, Task2, Task3]
  待機中: [Task4, Task5]
  完了済: [Task0]
  ```

## tmuxセッション構成（org特有）
- セッション名: org-system
- window 0: orchestrator本体
- window 1+: 各ワーカー（永続的Claude UI）

## ワーカー管理階層（org特有）
```
Orchestrator (window 0)
├── サブエージェント（Task/揮発性）
│   └── 並列実行される各タスク
└── tmuxワーカー（window 1+/永続的）
    └── 各プロジェクトのClaude
```

## 報告フォーマット（org標準）
```
## 動作確認済み: [タスク名]
- 結果: [成功/失敗]
- 詳細: [具体的内容]
```

## orchestrator禁止事項
- 直接のコード実装（必ずサブエージェント経由）
- 全タスク完了待機（即時報告・即時割り振り）
- 順次実行（並列実行を原則）

## 非同期実行の具体的実装
- libtmuxを使用した並列ワーカー管理
- 各ペインへの非同期コマンド送信
- capture-paneによる出力収集

## 並列実行のベストプラクティス
1. 独立したタスクは必ず並列化
2. I/O待機中は他タスクを実行
3. CPU集約的タスクは分散
4. 検索・読み込み・独立実装は並列実行を優先

## orgディレクトリ作業規則
- **orgアプリの改変**: このディレクトリ内でorgアプリケーション自体の改変・保守を行う
- **orgアプリの使用**: 他Claudeへの指示発行のみ（他ディレクトリの直接作業は禁止）
- **使用方法の参照**: すべての使用方法は`cli.sh.example`に記載
  - ユーザーの期待と異なる動作の場合、`cli.sh.example`のユースケース説明を確認
  - 指摘を受けた場合、まず`cli.sh.example`の記載内容を検証
- **セキュリティ方針**: 将来的にfirejailを使用した各ワーカーのサンドボックス化を検討中
  - 各ワーカーは指定ディレクトリのみアクセス可能
  - orchestratorは指示のみ、実作業は各ワーカーに委譲