# 目的駆動開発

## 原則

すべての実装は明確な目的に基づく。目的が不明な場合は、実装を開始してはならない。

## WHY-WHAT-HOWフレームワーク

### 1. WHY（なぜ）
- **問題の特定**: どのような問題を解決するのか
- **価値の明確化**: なぜその解決が必要なのか
- **影響範囲**: 解決により誰が恩恵を受けるのか

### 2. WHAT（何を）
- **成果物の定義**: 具体的に何を作るのか
- **成功基準**: 何が達成されれば成功とみなすのか
- **検証方法**: どうやって成功を確認するのか

### 3. HOW（どのように）
- **実装方針**: 技術的アプローチの概要
- **制約事項**: 守るべき制約や規約
- **リスク**: 想定される問題と対策

## 目的確認プロトコル

### タスク開始前の確認事項
```
1. このタスクの目的を1文で説明できるか？
2. 期待される結果を具体的に述べられるか？
3. 実装方針は既存の設計と整合しているか？
```

### 目的が不明な場合の対応
```
「このタスクについて確認させてください：
1. 解決したい問題は何ですか？（WHY）
2. 何が完成すれば成功ですか？（WHAT）
3. 技術的な制約はありますか？（制約）」
```

## 目的の文書化

### PURPOSE.md
プロジェクト全体の目的を記載：
- プロジェクトの存在理由
- 提供する価値
- 長期的なビジョン

### README.md
各ディレクトリの目的を記載：
- このディレクトリの役割
- 含まれる機能の説明
- 他のモジュールとの関係

### コメント・ドキュメント
実装レベルの目的を記載：
- なぜこの実装方法を選んだか
- どのような問題を解決しているか
- 将来の変更時の注意点

## アンチパターン

### 避けるべき行動
- **推測実装**: 「たぶんこうだろう」での実装
- **過剰な一般化**: 将来の不確実な要求への対応
- **目的なき最適化**: 問題が顕在化していない最適化
- **暗黙の前提**: 文書化されていない前提での設計

### 推奨される行動
- **明示的な確認**: 不明点は必ず確認
- **段階的な実装**: 小さく始めて検証しながら拡張
- **目的の記録**: 決定の理由を文書に残す
- **定期的な見直し**: 目的と実装の整合性確認

## 実装例

### 良い例
```typescript
// WHY: ユーザーが大量のデータを効率的に検索できるようにする
// WHAT: 全文検索機能を追加
// HOW: ElasticsearchのAPIを使用

export class SearchService {
  // 目的: 検索クエリを正規化し、Elasticsearchの形式に変換
  // 理由: ユーザー入力の揺れを吸収し、検索精度を向上
  normalizeQuery(userInput: string): ElasticsearchQuery {
    // ...
  }
}
```

### 悪い例
```typescript
// コメントなし、目的不明
export class DataProcessor {
  process(data: any): any {
    // 複雑な処理...
  }
}
```

## チェックリスト

実装前：
- [ ] タスクの目的（WHY）が明確か
- [ ] 成果物（WHAT）が定義されているか
- [ ] 実装方針（HOW）が適切か
- [ ] 既存の設計と整合しているか
- [ ] 目的がREADMEに記載されているか

実装後：
- [ ] 目的を達成したか
- [ ] 成功基準を満たしたか
- [ ] ドキュメントは更新したか
- [ ] 将来の保守者が理解できるか