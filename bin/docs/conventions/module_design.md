# モジュール設計

## 基本ルール

- **1ファイル1公開機能**: 1つのファイルは、主となる公開機能を1つだけ持つことを原則とします。
- **純粋関数を優先**: 可能な限り、副作用のない純粋な関数として機能を実装します。
- **高階関数で柔軟性を実現**: 依存性の注入や機能の拡張には、高階関数（関数を返す関数）を活用します。
- **プラグインベースの設計**: 機能は疎結合にし、必要に応じて組み合わせたり、差し替えたりできるような設計を心がけます。
- **`mod.{ext}`から一元エクスポート**: モジュール内の公開APIは、`mod.{ext}`（例: `mod.ts`, `__init__.py`）ファイルからまとめてエクスポートし、外部からの利用者はこのファイルのみを参照するようにします。
- **ESモジュールのみ使用**: JavaScript/TypeScriptではESモジュール（ESM）のみを使用し、CommonJS（require/module.exports）は禁止します。

## ディレクトリ構造

各モジュールは、以下の標準的なディレクトリ構造に従います。

```
module/
├── types.{ext}      # 型定義、データ構造
├── core.{ext}       # 純粋なビジネスロジック
├── adapters.{ext}   # 外部依存（インフラストラクチャ層）との接続部
└── mod.{ext}        # 公開APIのエクスポート
```

- `{ext}` は各言語の拡張子に読み替えてください。（例: `.ts`, `.py`, `.go`）
- Pythonの場合は `__init__.py` が `mod.py` の役割を担います。
