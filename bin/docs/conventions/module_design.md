# モジュール設計

## アーキテクチャ

軽量DDD（Domain-Driven Design）およびヘキサゴナルアーキテクチャの本質を取り入れた、関数主体のアーキテクチャを採用します。

## 基本ルール

- **1ファイル1公開機能**: 1つのファイルは、主となる公開機能を1つだけ持つことを原則とします。
- **純粋関数を優先**: 可能な限り、副作用のない純粋な関数として機能を実装します。
- **高階関数で柔軟性を実現**: 依存性の注入や機能の拡張には、高階関数（関数を返す関数）を活用します。
- **`mod.{ext}`から一元エクスポート**: モジュール内の公開APIは、`mod.{ext}`（例: `mod.ts`, `__init__.py`）ファイルからまとめてエクスポートし、外部からの利用者はこのファイルのみを参照するようにします。
- **ESモジュールのみ使用**: JavaScript/TypeScriptではESモジュール（ESM）のみを使用し、CommonJS（require/module.exports）は禁止します。

## 開始方法

### 最小構成（3ファイルから開始）

```
module/
├── application.{ext}    # ユースケース
├── domain.{ext}         # ビジネスロジック
├── infrastructure.{ext} # 外部接続
└── mod.{ext}           # エクスポート
```

### 成長時の分割

ファイルが大きくなったら同名ディレクトリに分割：

```
module/
├── application/
│   └── *.{ext}
├── domain/
│   └── *.{ext}
├── infrastructure/
│   └── *.{ext}
└── mod.{ext}
```

## 設計に迷ったら

「どの層に配置すべきか」「いつ分割すべきか」で迷った場合は、まず小さく実装し、必要に応じてリファクタリングしてください。
