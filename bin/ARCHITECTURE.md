# インターフェース層と他の3層の関係図

以下に、DDD（ドメイン駆動設計）のアーキテクチャにおける Interface 層内部の構造と、他の3つの層（Application、Domain、Infrastructure）との関係を図示します。

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                                                                             │
│ Interface Layer                                                             │
│ ┌───────────────┐  ┌───────────────┐  ┌───────────────┐  ┌───────────────┐ │
│ │    browser    │  │      cli      │  │    server     │  │    shared     │ │
│ │ ┌───────────┐ │  │               │  │               │  │ ┌───────────┐ │ │
│ │ │   react   │ │  │               │  │               │  │ │ constants │ │ │
│ │ │           │ │  │               │  │               │  │ │   types   │ │ │
│ │ │components │ │  │               │  │               │  │ │   utils   │ │ │
│ │ │containers │ │  │               │  │               │  │ │viewModels │ │ │
│ │ └───────────┘ │  │               │  │               │  │ └───────────┘ │ │
│ └───────┬───────┘  └───────┬───────┘  └───────┬───────┘  └───────────────┘ │
│         │                  │                  │                             │
│ ┌───────┴──────────────────┴──────────────────┴───────────────────┐ ┌─────────┐ │
│ │                         client                              │ │adapters │ │
│ │  ┌──────────┐  ┌──────────┐  ┌──────────┐  ┌──────────┐     │ │         │ │
│ │  │ actions  │  │presenters│  │  state   │  │validations│    │ │  api    │ │
│ │  └──────────┘  └──────────┘  └──────────┘  └──────────┘     │ │ storage │ │
│ └──────────────────────────────────────────────────────────────┘ │analytics│ │
│                                                                  └─────────┘ │
└────────────────────────────────┬────────────────────────────────────────────┘
                                 │
                                 ▼
┌────────────────────────────────┴────────────────────────────────────────────┐
│                                                                             │
│ Application Layer                                                           │
│                                                                             │
│ ┌───────────────────┐  ┌───────────────────┐  ┌───────────────────┐        │
│ │    UseCases       │  │     Services      │  │   DTOs/Mappers    │        │
│ └─────────┬─────────┘  └─────────┬─────────┘  └─────────┬─────────┘        │
│           │                      │                      │                   │
└───────────┼──────────────────────┼──────────────────────┼───────────────────┘
            │                      │                      │
            ▼                      ▼                      ▼
┌───────────┴──────────────────────┴──────────────────────┴───────────────────┐
│                                                                             │
│ Domain Layer                                                                │
│                                                                             │
│ ┌───────────────────┐  ┌───────────────────┐  ┌───────────────────┐        │
│ │     Entities      │  │Domain Services    │  │Value Objects      │        │
│ └───────────────────┘  └───────────────────┘  └───────────────────┘        │
│                                                                             │
│ ┌───────────────────┐  ┌───────────────────┐  ┌───────────────────┐        │
│ │   Aggregates      │  │   Repositories    │  │     Events        │        │
│ │   (interfaces)    │  │   (interfaces)    │  │                   │        │
│ └─────────┬─────────┘  └─────────┬─────────┘  └───────────────────┘        │
│           │                      │                                          │
└───────────┼──────────────────────┼──────────────────────────────────────────┘
            │                      │
            ▼                      ▼
┌───────────┴──────────────────────┴──────────────────────────────────────────┐
│                                                                             │
│ Infrastructure Layer                                                        │
│                                                                             │
│ ┌───────────────────┐  ┌───────────────────┐  ┌───────────────────┐        │
│ │  Repository Impls │  │   External APIs   │  │    Databases      │        │
│ └───────────────────┘  └───────────────────┘  └───────────────────┘        │
│                                                                             │
│ ┌───────────────────┐  ┌───────────────────┐  ┌───────────────────┐        │
│ │    Messaging      │  │   File Systems    │  │    Security       │        │
│ └───────────────────┘  └───────────────────┘  └───────────────────┘        │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

## 各層の依存関係

この図は以下の依存関係を示しています：

1. **Interface層**：
   - ユーザーとの対話を担当（UI、API、CLI等）
   - Application層に依存し、ユースケースを呼び出す
   - 特定のプラットフォーム（ブラウザ、CLI、サーバー）ごとに分割
   - shared: 共通コンポーネント
   - client: ブラウザ固有だがフレームワーク非依存
   - adapters: 外部システムとの連携

2. **Application層**：
   - ユースケース（アプリケーション固有のビジネスロジック）を実装
   - Domain層に依存し、ドメインオブジェクトを操作

3. **Domain層**：
   - ビジネスロジックの中核
   - エンティティ、値オブジェクト、ドメインサービスを含む
   - 他の層に依存しない（最も安定した層）

4. **Infrastructure層**：
   - 技術的な実装の詳細を提供
   - Domain層で定義されたインターフェースを実装
   - 外部システム、データベース、メッセージングなどを含む

この構造により、ドメインロジックを明確に分離し、UIレンダラー（React）からの独立性を保ちながら、柔軟で拡張性のあるアーキテクチャを実現します。
